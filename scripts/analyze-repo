#!/bin/bash

# Repository Compliance Analyzer Wrapper
# 
# Usage: ./scripts/analyze-repo owner/repo
# 
# Automatically detects and uses Node.js or Python based on availability
# Examples:
#   ./scripts/analyze-repo RockRunner007/template
#   ./scripts/analyze-repo facebook/react
#   ./scripts/analyze-repo google/go-cloud

set -e

# Check arguments
if [ $# -eq 0 ]; then
  echo "Usage: $0 <owner>/<repo>"
  echo ""
  echo "Examples:"
  echo "  $0 RockRunner007/template"
  echo "  $0 facebook/react"
  echo ""
  echo "Options:"
  echo "  GITHUB_TOKEN=<token>      - GitHub API token for higher rate limits"
  echo "  OUTPUT_FORMAT=json        - Output as JSON instead of text"
  echo ""
  echo "For more info, see: docs/tools/repository-analyzer.md"
  exit 1
fi

# Try Node.js first
if command -v node &> /dev/null; then
  exec node "$(dirname "$0")/analyze-repo.js" "$@"
fi

# Fall back to Python
if command -v python3 &> /dev/null; then
  exec python3 "$(dirname "$0")/analyze-repo.py" "$@"
fi

echo "Error: Neither Node.js nor Python 3 found"
echo "Please install Node.js 14+ or Python 3.6+"
exit 1
