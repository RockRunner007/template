sequenceDiagram
    participant User as User/Browser
    participant Frontend as Frontend App
    participant API as Auth API
    participant Service as User Service
    participant DB as Database
    participant Email as Email Service

    rect rgb(200, 150, 255)
    note right of User: Registration Flow
    User->>Frontend: Enter email & password
    Frontend->>Frontend: Validate inputs
    Frontend->>API: POST /auth/register
    API->>Service: Create user account
    Service->>DB: Insert user (email, password_hash)
    DB->>Service: âœ“ User created
    Service->>Email: Send verification email
    Email-->>User: Verification email
    API-->>Frontend: 201 Created
    Frontend->>User: Show success message
    end

    rect rgb(150, 200, 255)
    note right of User: Login Flow
    User->>Frontend: Enter email & password
    Frontend->>API: POST /auth/login
    API->>Service: Verify credentials
    Service->>DB: Query user by email
    DB->>Service: Return user with hash
    Service->>Service: Compare password hash
    Service->>Service: Generate JWT token
    API->>DB: Create session record
    API-->>Frontend: 200 OK + token
    Frontend->>Frontend: Store token (localStorage)
    Frontend->>User: Redirect to dashboard
    end

    rect rgb(150, 255, 150)
    note right of User: API Call with Auth
    User->>Frontend: Request user profile
    Frontend->>Frontend: Get token from storage
    Frontend->>API: GET /user/profile + Authorization header
    API->>API: Validate JWT token
    API->>Service: Get user profile
    Service->>DB: Query user
    DB->>Service: Return profile
    API-->>Frontend: 200 OK + profile data
    Frontend->>User: Display profile
    end

    rect rgb(255, 200, 150)
    note right of User: Logout Flow
    User->>Frontend: Click logout
    Frontend->>Frontend: Delete token from storage
    Frontend->>API: POST /auth/logout (optional)
    API->>DB: Invalidate session
    API-->>Frontend: 200 OK
    Frontend->>User: Redirect to login
    end
