erDiagram
    USER ||--o{ SESSION : "has multiple"
    USER ||--o{ PASSWORD_RESET : "can request"
    USER ||--o{ AUDIT_LOG : "generates"

    USER {
        int id PK
        string email UK "unique, indexed"
        string password_hash "bcrypt hash"
        string first_name
        string last_name
        boolean email_verified
        timestamp verified_at
        int failed_login_attempts
        timestamp locked_until
        timestamp created_at
        timestamp updated_at
    }

    SESSION {
        string id PK "JWT token identifier"
        int user_id FK "references USER.id"
        string token_hash "hash of JWT"
        timestamp created_at
        timestamp expires_at
        timestamp last_activity
        string ip_address
        string user_agent
    }

    PASSWORD_RESET {
        string id PK "unique token"
        int user_id FK "references USER.id"
        string email "email at time of reset"
        boolean used
        timestamp created_at
        timestamp expires_at
        timestamp used_at
    }

    AUDIT_LOG {
        int id PK
        int user_id FK
        string action "login, logout, register, password_reset"
        string status "success, failure"
        string ip_address
        string user_agent
        string error_message
        timestamp created_at
    }
